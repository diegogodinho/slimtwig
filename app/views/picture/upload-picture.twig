{% extends 'default.twig' %}
{% block content %}  

<style>
img {
  max-width: 100%; /* This rule is very important, please do not ignore this! */
}
</style> 
<div class="input-group">
    <label class="btn btn-primary btn-upload" for="inputImage" title="Upload image file" style="margin-top: 10px">
        <input type="file" class="sr-only" id="inputImage" name="file"  accept="image/*">
        <span class="docs-tooltip" data-toggle="tooltip" title="" data-original-title="Import image with Blob URLs">
            <span class="fa fa-upload"></span>&nbsp;Upload
        </span>
    </label>	    
</div>
<div class="modal fade" id="modalCropper" role="dialog" aria-labelledby="modalLabel" tabindex="-1">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="modalLabel">Seleção de Imagem</h4>
            </div>
            {# <form action="/Picture/SavePicture" method="post" enctype="multipart/form-data" id="formUploadImagem"> #}
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-9">
                                <!-- <h3>Demo:</h3> -->
                            <div class="img-container">
                                <img id="imgprincipal" src="" alt="Picture">
                            </div>
                        </div>
                        <div class="col-md-3">
                                 <h3>Preview:</h3>
                            <div class="docs-preview clearfix">
                                <div class="img-preview preview-lg"></div>
                                <div class="img-preview preview-md"></div>
                                <div class="img-preview preview-sm"></div>
                                <div class="img-preview preview-xs"></div>
                            </div>
                        </div>                        
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" id="salveFoto">Salvar</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                </div>
            {# </form> #}
        </div>
    </div>
</div>


{% endblock %}

{% block script %}  
<script type="text/javascript">
    $(function() {        

        var URL = window.URL || window.webkitURL;        

        var blobURL;

        var $image = $('#imgprincipal');       

        var options = {
            toggleDragModeOnDblclick: false,
            cropBoxResizable: false,
            movable: false,
            rotatable: false,
            scalable: false,
            zoomable: false,
            zoomOnTouch: false,
            zoomOnWheel: false,
            aspectRatio: 16 / 9,
            dragMode: 'move',
            preview: '.img-preview',
            cropBoxResizable: false,
            crop: function (data) {                
                $('#EixoX').val(Math.round(data.x));
                $('#EixoY').val(Math.round(data.y));
                $('#Altura').val(Math.round(data.height));
                $('#Largura').val(Math.round(data.width));
            },            
            ready:function(){                                
            }
        };      


        $image.cropper('destroy').cropper(options);        
        

        $('#inputImage').change(function(){            
            if (URL) {                
                var files = this.files;
                

                if (!$image.data('cropper')) {
                    return;
                }

                if (files && files.length) {
                    file = files[0];

                    if (/^image\/\w+$/.test(file.type)) {                        
                        blobURL = URL.createObjectURL(file);
                        $('#modalCropper').modal('show'); 
                    } else {
                        window.alert('Please choose an image file.');
                    }
                }
                
            } 
            else {
                $('#inputImage').prop('disabled', true).parent().addClass('disabled');
            }

        });

        $('#modalCropper').on('shown.bs.modal', function (e) {            
            $image.cropper('destroy').attr('src', blobURL).cropper(options);
            $('#inputImage').val('');
        });

    });
</script>
  

{% endblock %}

